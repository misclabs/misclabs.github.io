function L(){const t=performance.now()/1e3-Number.MIN_VALUE,e={dtS:0,tmS:0,tck:()=>{const r=performance.now()/1e3-t;e.dtS=r-e.tmS,e.tmS=r}};return e}function F(t,e,r,n,a){return{durS:t,strt:e,end:r,updtFn:n,esFn:a,tS:0,dir:1}}function P(t,e){return t.updtFn(t,e),t.strt+(t.end-t.strt)*t.esFn(t.tS/t.durS)}function R(t,e){t.tS>=t.durS||(t.tS=Math.min(t.durS,t.tS+e))}function x(t){return t=1-t,1-t*t*t*t}function I(t,e,r){const n=t.getContext("webgl");if(!n)throw new Error(`Failed to initialize WebGL context for canvas ${t.id}.`);return[n,T(n,e,r)]}function T(t,e,r){const n=A(t,t.VERTEX_SHADER,e),a=A(t,t.FRAGMENT_SHADER,r),o=t.createProgram();if(!o)throw new Error("Failed creating shader program");if(t.attachShader(o,n),t.attachShader(o,a),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS))return o;const h=t.getProgramInfoLog(o);throw t.deleteProgram(o),h?new Error(h):new Error("Failed creating shader program")}function _(t){const[e,r]=I(t,"uniform vec2 scrSz;uniform vec4 trans;attribute vec2 scrPos;void main(){/* Scale */ vec2 pos=scrPos*trans.w; /* Rotate */ vec2 r=vec2(sin(trans.z),cos(trans.z)); pos=vec2(pos.x*r.y+pos.y*r.x, pos.y*r.y-pos.x*r.x); /* Translate */ pos=pos+trans.xy; /* Clip space */ pos=((pos / scrSz) * 2.0) - 1.0; gl_Position=vec4(pos * vec2(1, -1), 0, 1); }","precision mediump float;uniform vec4 col;void main(){gl_FragColor=col;}");C(t);const n=e.getUniformLocation(r,"scrSz"),a=e.getUniformLocation(r,"col"),o=e.getUniformLocation(r,"trans"),h=e.getAttribLocation(r,"scrPos"),g=e.createBuffer(),d=[],l=[];let m=!1;const s={clrCol:[0,0,0,1],begin:function(){if(m)throw new Error("Already began drawing");m=!0,C(t);const{w:i,h:c}=s.scrSz();e.viewport(0,0,i,c),e.clearColor(s.clrCol[0],s.clrCol[1],s.clrCol[2],s.clrCol[3]),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(r),e.uniform2f(n,i,c)},end:function(){if(!m)throw new Error("Drawing never began");function i(c,u,f,p,S,w=!1){e.bindBuffer(e.ARRAY_BUFFER,u),e.enableVertexAttribArray(c),e.vertexAttribPointer(c,S,p,w,0,0),e.bufferData(e.ARRAY_BUFFER,f,e.DYNAMIC_DRAW)}i(h,g,new Float32Array(d),e.FLOAT,2);for(let c=0;c<l.length;++c)e.uniform4fv(a,l[c].col4fv),e.uniform4fv(o,l[c].trans),e.drawArrays(e.TRIANGLES,l[c].dtStrt,l[c].dtCnt);d.length=0,l.length=0,m=!1},scrSz:function(){return{w:e.canvas.width,h:e.canvas.height}},tri:function(i,c,u,f,p,S,w){l.push({dtStrt:d.length/2,dtCnt:3,col4fv:w,trans:[0,0,0,1]}),d.push(i,c,u,f,p,S)},rect:function(i,c,u,f,p,S,w){const b=[-u/2,-f/2],v=[u/2,f/2];l.push({dtStrt:d.length/2,dtCnt:6,col4fv:w,trans:[i,c,p,S]}),d.push(b[0],b[1],u/2,-f/2,v[0],v[1],b[0],b[1],v[0],v[1],-u/2,f/2)}};return s}function A(t,e,r){const n=t.createShader(e);if(!n)throw new Error(`Failed creating shader of type ${e} with context ${t} src: ${r}`);if(t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return n;const a=t.getShaderInfoLog(n);throw t.deleteShader(n),a?new Error(a):new Error(`Failed creating shader of type ${e} with context ${t} src: ${r}`)}function C(t){const e=window.devicePixelRatio,{width:r,height:n}=t.getBoundingClientRect();(t.width!=Math.round(r*e)||t.height!=Math.round(n*e))&&(t.width=t.clientWidth,t.height=t.clientHeight)}const y=document.getElementById("cr");y&&y.addEventListener("click",()=>{const t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=window.screen.width,n=window.screen.height,a=document.body.clientWidth,o=document.body.clientHeight;y.innerText=`scr:${r},${n} vp:${t},${e} b:${a},${o}`});const E=document.querySelector("#splshA");if(E){const t=document.createElement("img");t.alt='An abstract blue and pink repesentation of a caffeine molecule with squares, hearts, and the text "Misc. Labs"',t.width=512,t.height=256,t.style.visibility="hidden",t.onload=()=>{const e=document.createElement("canvas");e.style.visibility="hidden",E.appendChild(e);const r=_(e);r.clrCol=[26/256,26/256,26/256,1];const{w:n,h:a}=r.scrSz(),o=[],h=n/16,g=a/9;for(let s=0;s<16;++s)for(let i=0;i<9;++i)o.push({x:s*h+h/2,y:i*g+g/2,w:h,h:g,s:0,r:0});const d=L(),l=F(3,0,1,R,x),m=setInterval(()=>{d.tck();const s=P(l,d.dtS);r.begin();for(let i=0;i<o.length;++i)o[i].s=s*1.1,o[i].r=-(1-s)*Math.PI/2,r.rect(o[i].x,o[i].y,o[i].w,o[i].h,o[i].r,o[i].s,[0,0,0,0]);r.end(),t.style.visibility="visible",e.style.visibility="visible",s>=1&&(clearInterval(m),r.begin(),r.end(),e.parentNode?.removeChild(e))},1e3/60)},E.appendChild(t),t.src="images/logos/misclabs_logo_hero.svg"}
